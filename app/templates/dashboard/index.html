{% extends "base.html" %}
{% block content %}
<div class="dashboard-grid">
    <section class="card hero">
        <header class="hero-headline">
            <div>
                <p class="eyebrow">Fundamental Ecom LLC</p>
                <h1>Welcome, {{ user.full_name }}</h1>
                <p class="status-line">
                    <span class="status-badge" data-status-badge>--</span>
                    <span class="status-meta" data-status-meta>Awaiting first action</span>
                    <span class="status-duration" data-status-duration></span>
                </p>
            </div>
            <div class="hero-clock">
                <p class="clock-label">Live Clock</p>
                <p class="clock-time" data-live-clock>--:--</p>
                <p class="clock-zone" data-timezone-display>--</p>
            </div>
        </header>
        <div class="hero-metrics">
            <article class="metric" data-summary-metric="work_minutes">
                <p>Work minutes</p>
                <strong>0</strong>
            </article>
            <article class="metric" data-summary-metric="lunch_minutes">
                <p>Lunch minutes</p>
                <strong>0</strong>
            </article>
            <article class="metric" data-summary-metric="short_break_minutes">
                <p>Break minutes</p>
                <strong>0</strong>
            </article>
            <article class="metric" data-summary-metric="net_hours">
                <p>Net hours</p>
                <strong>0.00</strong>
            </article>
        </div>
    </section>

    <section class="card controls-card">
        <header>
            <h2>Realtime Session Controls</h2>
            <p class="muted">Each action instantly updates the log and chat space.</p>
        </header>
        <div class="controls-grid" data-session-controls>
            <button data-action="start-work">Start Work</button>
            <button data-action="stop-work">Stop Work</button>
            <button data-action="start-lunch">Start Lunch</button>
            <button data-action="end-lunch">End Lunch</button>
            <button data-action="start-break">Start Break</button>
            <button data-action="end-break">End Break</button>
        </div>
        <div class="timezone-panel">
            <div>
                <label for="timezone-select">Display timezone</label>
                <select id="timezone-select" data-timezone-select></select>
            </div>
            <div class="timezone-actions">
                <button type="button" data-timezone-reset>Use device time</button>
                <button type="button" class="secondary" data-timezone-save>Save preference</button>
            </div>
            <p class="timezone-feedback" data-timezone-feedback></p>
        </div>
        <p class="control-feedback" data-control-feedback></p>
    </section>

    <section class="card insights-card">
        <header>
            <h2>Operational Summary</h2>
            <p class="muted">Lunch, break, and roll-call insights.</p>
            <div class="summary-filter" data-summary-filter>
                <label>
                    <span>Range</span>
                    <select data-summary-range>
                        <option value="day" selected>Today</option>
                        <option value="week">Last 7 days</option>
                        <option value="month">Last 30 days</option>
                        <option value="custom">Custom</option>
                    </select>
                </label>
                <div class="summary-filter-custom" data-summary-custom hidden>
                    <input type="date" data-summary-start>
                    <input type="date" data-summary-end>
                    <button type="button" data-summary-apply>Apply</button>
                </div>
                <p class="summary-filter-status" data-summary-filter-status></p>
                <p class="summary-range-label" data-summary-range-label>Today</p>
            </div>
        </header>
        <table class="insights-table">
            <tbody>
            <tr>
                <th>Lunch minutes</th>
                <td data-summary-metric="lunch_minutes">0</td>
            </tr>
            <tr>
                <th>Break minutes</th>
                <td data-summary-metric="short_break_minutes">0</td>
            </tr>
            <tr>
                <th>Overbreak</th>
                <td data-summary-metric="overbreak_minutes">0</td>
            </tr>
            <tr>
                <th>Roll-call deductions</th>
                <td data-summary-metric="rollcall_deduction_minutes">0</td>
            </tr>
            <tr>
                <th>Net work hours</th>
                <td data-summary-net-hours-display>0:00</td>
            </tr>
            </tbody>
        </table>
        <section class="activity-log">
            <h3>Activity log</h3>
            <ul data-activity-log></ul>
        </section>
    </section>

    <section class="card team-presence-card">
        <header>
            <h2>Team Presence</h2>
            <p class="muted">Live status across your org.</p>
        </header>
        <ul class="team-presence-list" data-team-roster></ul>
    </section>

    <section class="card schedule-card">
        <header>
            <h2>My Shifts</h2>
            <p class="muted">Times shown in <span data-shift-schedule-tz>--</span></p>
        </header>
        <ul class="shift-schedule" data-shift-schedule></ul>
    </section>

</div>
<script id="dashboard-state" type="application/json">{{ dashboard_state | tojson | safe }}</script>
{% endblock %}
